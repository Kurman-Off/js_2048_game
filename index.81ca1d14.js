var e,n,r,t,u,o=[],c=!1;function l(){var e=document.querySelectorAll(".field-row"),n=[];return e.forEach(function(e){var r=e.querySelectorAll(".field-cell"),t=[];r.forEach(function(e){t.push(e.textContent)}),n.push(t)}),n}function f(e){return e[0].map(function(n,r){return e.map(function(e){return e[r]})})}function i(e){var n=[];if(e.forEach(function(e,r){e.forEach(function(e,t){""===e&&n.push({rowIndex:r,colIndex:t})})}),n.length>0){var r=Math.floor(Math.random()*n.length),t=n[r],u=t.rowIndex,o=t.colIndex;e[u][o]=.1>Math.random()?4:2,document.querySelectorAll(".field-row")[u].querySelectorAll(".field-cell")[o].textContent=e[u][o]}}function a(e){if(!c){var n=e.map(function(e){for(var n=[],r=[],t=0;t<e.length;t++){var u=Number(e[t]);isNaN(u)||0===u||n.push(u)}n.reverse();for(var c=0;c<n.length;c++)n[c]===n[c+1]?(r.push(2*n[c]),o.push(2*n[c]),c++):r.push(n[c]);for(r.reverse();r.length<e.length;)r.unshift("");return r}),r=!e.every(function(e,r){return e.every(function(e,t){return Number(e)===Number(n[r][t])})});return n.forEach(function(e,n){e.forEach(function(e,r){document.querySelectorAll(".field-row")[n].querySelectorAll(".field-cell")[r].textContent=e})}),r&&i(n),m(o.reduce(function(e,n){return e+n},0)),v(n),y(n),n}}function s(e){if(!c){var n=e.map(function(e){for(var n=[],r=[],t=0;t<e.length;t++){var u=Number(e[t]);isNaN(u)||0===u||n.push(u)}for(var c=0;c<n.length;c++)n[c]===n[c+1]?(r.push(2*n[c]),o.push(2*n[c]),c++):r.push(n[c]);for(;r.length<e.length;)r.push("");return r}),r=!e.every(function(e,r){return e.every(function(e,t){return Number(e)===Number(n[r][t])})});return n.forEach(function(e,n){e.forEach(function(e,r){document.querySelectorAll(".field-row")[n].querySelectorAll(".field-cell")[r].textContent=e})}),r&&i(n),m(o.reduce(function(e,n){return e+n},0)),v(n),y(n),n}}function h(e){if(!c){var n=f(e).map(function(e){for(var n=[],r=[],t=0;t<e.length;t++){var u=Number(e[t]);isNaN(u)||0===u||n.push(u)}for(var c=0;c<n.length;c++)n[c]===n[c+1]?(r.push(2*n[c]),o.push(2*n[c]),c++):r.push(n[c]);for(;r.length<e.length;)r.push("");return r}),r=f(n),t=!e.every(function(e,n){return e.every(function(e,t){return Number(e)===Number(r[n][t])})});return r.forEach(function(e,n){e.forEach(function(e,r){document.querySelectorAll(".field-row")[n].querySelectorAll(".field-cell")[r].textContent=e})}),t&&i(r),m(o.reduce(function(e,n){return e+n},0)),v(r),y(r),r}}function d(e){if(!c){var n=f(e).map(function(e){for(var n=[],r=[],t=0;t<e.length;t++){var u=Number(e[t]);isNaN(u)||0===u||n.push(u)}n.reverse();for(var c=0;c<n.length;c++)n[c]===n[c+1]?(r.push(2*n[c]),o.push(2*n[c]),c++):r.push(n[c]);for(r.reverse();r.length<e.length;)r.unshift("");return r}),r=f(n),t=!e.every(function(e,n){return e.every(function(e,t){return Number(e)===Number(r[n][t])})});return r.forEach(function(e,n){e.forEach(function(e,r){document.querySelectorAll(".field-row")[n].querySelectorAll(".field-cell")[r].textContent=e})}),t&&i(r),m(o.reduce(function(e,n){return e+n},0)),v(r),y(r),r}}function m(e){var n=document.querySelector(".game-score");n&&(n.textContent=e)}function v(e){if(e.some(function(e){return e.some(function(e){return e>=2048})})){var n=document.querySelector(".message-win");n&&(n.style.display="block",c=!0)}}function y(e){if(e.every(function(e){return e.every(function(e){return 0!==Number(e)})})&&!e.some(function(n,r){return n.some(function(t,u){var o=u<n.length-1&&Number(t)===Number(n[u+1]),c=r<e.length-1&&Number(t)===Number(e[r+1][u]);return o||c})})){var n=document.querySelector(".message-lose");n&&(n.style.display="block",c=!0)}}e=document.querySelector(".start"),n=document.querySelector(".message-start"),r=document.querySelector(".message-win"),t=document.querySelector(".message-lose"),u=!1,e.addEventListener("click",function(){if(u=!u){var f,v,y,p,g,N=l();e.textContent="Restart",n.style.display="none",f={ArrowRight:a,ArrowLeft:s,ArrowUp:h,ArrowDown:d},document.addEventListener("keydown",function(e){if(!c){var n=l(),r=f[e.key];r&&r(n)}}),v=0,y=0,p=0,g=0,document.addEventListener("touchstart",function(e){v=e.changedTouches[0].screenX,y=e.changedTouches[0].screenY}),document.addEventListener("touchmove",function(e){p=e.changedTouches[0].screenX,g=e.changedTouches[0].screenY}),document.addEventListener("touchend",function(){var e,n;Math.abs(e=p-v)>Math.abs(n=g-y)?e>0?a(l()):s(l()):n>0?d(l()):h(l())}),i(N),i(N)}else e.textContent="Start",n.style.display="block",r.style.display="none",t.style.display="none",c=!1,document.querySelectorAll(".field-row").forEach(function(e){e.querySelectorAll(".field-cell").forEach(function(e){e.textContent=""})}),o.length=0,m(0)});
//# sourceMappingURL=index.81ca1d14.js.map
